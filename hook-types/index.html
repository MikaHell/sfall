<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/sfall/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/sfall/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/sfall/assets/js/vendor/lunr.min.js"></script> <script src="/sfall/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/sfall/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Hook types | sfall</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Hook types" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Sfall documentation" /> <meta property="og:description" content="Sfall documentation" /> <link rel="canonical" href="/sfall/hook-types/" /> <meta property="og:url" content="/sfall/hook-types/" /> <meta property="og:site_name" content="sfall" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Hook types" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Sfall documentation","headline":"Hook types","url":"/sfall/hook-types/"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png"> <link rel="manifest" href="/assets/favicon/site.webmanifest"> <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/sfall/" class="site-title lh-tight"> sfall </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/sfall/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Arrays category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/arrays/" class="nav-list-link">Arrays</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/array-functions/" class="nav-list-link">Array functions</a></li><li class="nav-list-item"><a href="/sfall/lists/" class="nav-list-link">Lists</a></li></ul></li><li class="nav-list-item"><a href="/sfall/best-practices/" class="nav-list-link">Best practices</a></li><li class="nav-list-item"><a href="/sfall/data-types/" class="nav-list-link">Data types</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Global scripts category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/global-scripts/" class="nav-list-link">Global scripts</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/global-script-functions/" class="nav-list-link">Global script functions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Hooks category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/hooks/" class="nav-list-link">Hooks</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/hook-functions/" class="nav-list-link">Hook functions</a></li><li class="nav-list-item"><a href="/sfall/hook-types/" class="nav-list-link">Hook types</a></li></ul></li><li class="nav-list-item"><a href="/sfall/sslc/" class="nav-list-link">SSLC</a></li><li class="nav-list-item"><a href="/sfall/optimization/" class="nav-list-link">Optimization</a></li><li class="nav-list-item"><a href="/sfall/animations/" class="nav-list-link">Animations</a></li><li class="nav-list-item"><a href="/sfall/art-and-appearance/" class="nav-list-link">Art and appearance</a></li><li class="nav-list-item"><a href="/sfall/audio/" class="nav-list-link">Audio</a></li><li class="nav-list-item"><a href="/sfall/car/" class="nav-list-link">Car</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Combat category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/combat/" class="nav-list-link">Combat</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/knockback/" class="nav-list-link">Knockback</a></li><li class="nav-list-item"><a href="/sfall/weapons-and-ammo/" class="nav-list-link">Weapons and ammo</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Direct memory access category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/direct-memory-access/" class="nav-list-link">Direct memory access</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/call_offset_vx/" class="nav-list-link">call_offset_vX</a></li><li class="nav-list-item"><a href="/sfall/read_xxx/" class="nav-list-link">read_xxx</a></li><li class="nav-list-item"><a href="/sfall/write_xxx/" class="nav-list-link">write_xxx</a></li></ul></li><li class="nav-list-item"><a href="/sfall/explosions/" class="nav-list-link">Explosions</a></li><li class="nav-list-item"><a href="/sfall/global-variables/" class="nav-list-link">Global variables</a></li><li class="nav-list-item"><a href="/sfall/graphics/" class="nav-list-link">Graphics</a></li><li class="nav-list-item"><a href="/sfall/ini-settings/" class="nav-list-link">INI settings</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Interface category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/interface/" class="nav-list-link">Interface</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/cursor/" class="nav-list-link">Cursor</a></li><li class="nav-list-item"><a href="/sfall/inventory/" class="nav-list-link">Inventory</a></li><li class="nav-list-item"><a href="/sfall/main-interface/" class="nav-list-link">Main interface</a></li><li class="nav-list-item"><a href="/sfall/outline/" class="nav-list-link">Outline</a></li><li class="nav-list-item"><a href="/sfall/pip-boy/" class="nav-list-link">Pip-Boy</a></li><li class="nav-list-item"><a href="/sfall/tags/" class="nav-list-link">Tags</a></li><li class="nav-list-item"><a href="/sfall/windows-and-images/" class="nav-list-link">Windows and images</a></li></ul></li><li class="nav-list-item"><a href="/sfall/keyboard-and-mouse/" class="nav-list-link">Keyboard and mouse</a></li><li class="nav-list-item"><a href="/sfall/locks/" class="nav-list-link">Locks</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Maps and encounters category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/maps-and-encounters/" class="nav-list-link">Maps and encounters</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/rest/" class="nav-list-link">Rest</a></li><li class="nav-list-item"><a href="/sfall/worldmap/" class="nav-list-link">Worldmap</a></li></ul></li><li class="nav-list-item"><a href="/sfall/objects-and-scripts/" class="nav-list-link">Objects and scripts</a></li><li class="nav-list-item"><a href="/sfall/other/" class="nav-list-link">Other</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Perks and traits category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/perks-and-traits/" class="nav-list-link">Perks and traits</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/npc-perks/" class="nav-list-link">NPC perks</a></li></ul></li><li class="nav-list-item"><a href="/sfall/sfall-funcx-macros/" class="nav-list-link">Sfall funcX macros</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Sfall category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/sfall/" class="nav-list-link">Sfall</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/funcx/" class="nav-list-link">funcX</a></li><li class="nav-list-item"><a href="/sfall/version/" class="nav-list-link">Version</a></li></ul></li><li class="nav-list-item"><a href="/sfall/skills/" class="nav-list-link">Skills</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Stats category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/stats/" class="nav-list-link">Stats</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/alter-min-max/" class="nav-list-link">Alter min/max</a></li></ul></li><li class="nav-list-item"><a href="/sfall/tiles-and-paths/" class="nav-list-link">Tiles and paths</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Utility category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/sfall/utility/" class="nav-list-link">Utility</a><ul class="nav-list"><li class="nav-list-item"><a href="/sfall/math/" class="nav-list-link">Math</a></li><li class="nav-list-item"><a href="/sfall/strings/" class="nav-list-link">Strings</a></li></ul></li><li class="nav-list-item"><a href="/sfall/virtual-file-system/" class="nav-list-link">Virtual file system</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search sfall" aria-label="Search sfall" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://nma-fallout.com/threads/fo2-engine-tweaks-sfall.178390/" class="site-button" > Forum </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/phobos2077/sfall/" class="site-button" > GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/sfall/hooks/">Hooks</a></li> <li class="breadcrumb-nav-list-item"><span>Hook types</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 class="no_toc" id="hook-types"> <a href="#hook-types" class="anchor-heading" aria-labelledby="hook-types"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook types </h1> <ul id="markdown-toc"> <li><a href="#adjustfid" id="markdown-toc-adjustfid">AdjustFID</a></li> <li><a href="#adjustpoison" id="markdown-toc-adjustpoison">AdjustPoison</a></li> <li><a href="#adjustrads" id="markdown-toc-adjustrads">AdjustRads</a></li> <li><a href="#afterhitroll" id="markdown-toc-afterhitroll">AfterHitRoll</a></li> <li><a href="#ammocost" id="markdown-toc-ammocost">AmmoCost</a></li> <li><a href="#barterprice" id="markdown-toc-barterprice">BarterPrice</a></li> <li><a href="#bestweapon" id="markdown-toc-bestweapon">BestWeapon</a></li> <li><a href="#buildsfxweapon" id="markdown-toc-buildsfxweapon">BuildSfxWeapon</a></li> <li><a href="#calcapcost" id="markdown-toc-calcapcost">CalcAPCost</a></li> <li><a href="#canuseweapon" id="markdown-toc-canuseweapon">CanUseWeapon</a></li> </ul><hr /> <h2 id="adjustfid"> <a href="#adjustfid" class="anchor-heading" aria-labelledby="adjustfid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustFID </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTFID</code> (hs_adjustfid.int)</p> <p>Runs after calculating character figure FID on the inventory screen, whenever the game decides that character appearance might change. Also happens on other screens, like barter.</p> <p><strong>NOTE:</strong> FID has following format: <code class="language-plaintext highlighter-rouge">0x0ABBCDDD</code>, where: <code class="language-plaintext highlighter-rouge">A</code> - object type, <code class="language-plaintext highlighter-rouge">BB</code> - animation code (always 0 in this case), <code class="language-plaintext highlighter-rouge">C</code> - weapon code, <code class="language-plaintext highlighter-rouge">DDD</code> - FRM index in LST file.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the vanilla FID calculated by the engine according to critter base FID and armor/weapon being used
int     arg1 - the modified FID calculated by the internal sfall code (like Hero Appearance Mod)

int     ret0 - overrides the calculated FID with provided value
</code></pre></div></div> <h2 id="adjustpoison"> <a href="#adjustpoison" class="anchor-heading" aria-labelledby="adjustpoison"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustPoison </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTPOISON</code> (hs_adjustpoison.int)</p> <p>Runs when a critter’s poison level is changed, or when the player takes damage from the poison.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter
int     arg1 - the amount of poison being added/removed
int     arg2 - the damage value at the time of applying the poison effect
               (damage from the poison effect is implemented only for the player character; for other critters, this value will always be 0)

int     ret0 - the new amount of poison being added/removed
int     ret1 - the new damage value, only negative values are allowed (will only be valid at the time of taking damage from the poison)
</code></pre></div></div> <h2 id="adjustrads"> <a href="#adjustrads" class="anchor-heading" aria-labelledby="adjustrads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustRads </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTRADS</code> (hs_adjustrads.int)</p> <p>Runs when a critter’s radiation level is changed.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter (usually dude_obj)
int     arg1 - the amount of radiation being added/removed

int     ret0 - the new amount of radiation being added/removed
</code></pre></div></div> <h2 id="afterhitroll"> <a href="#afterhitroll" class="anchor-heading" aria-labelledby="afterhitroll"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AfterHitRoll </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_AFTERHITROLL</code> (hs_afterhitroll.int)</p> <p>Runs after Fallout has decided if an attack will hit or miss.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - If the attack will hit: 0 - critical miss, 1 - miss, 2 - hit, 3 - critical hit
Critter arg1 - The attacker
Critter arg2 - The target of the attack
int     arg3 - The bodypart
int     arg4 - The hit chance

int     ret0 - Override the hit/miss
int     ret1 - Override the targeted bodypart
Critter ret2 - Override the target of the attack
</code></pre></div></div> <h2 id="ammocost"> <a href="#ammocost" class="anchor-heading" aria-labelledby="ammocost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AmmoCost </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_AMMOCOST</code> (hs_ammocost.int)</p> <p>Runs when calculating ammo cost for a weapon. Doesn’t affect damage, only how much ammo is spent.<br /> By default, a weapon can perform an attack with at least one ammo, regardless of ammo cost calculation.<br /> To add proper checks for ammo before attacking (hook type 1 <code class="language-plaintext highlighter-rouge">arg3</code>), set <strong>CheckWeaponAmmoCost=1</strong> in <strong>Misc</strong> section of ddraw.ini.</p> <p><strong>NOTE:</strong> The return value must be greater than or equal to 0 to be valid.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Item    arg0 - The weapon
int     arg1 - Number of bullets in burst or 1 for single shots
int     arg2 - The amount of ammo that will be consumed, calculated by the original ammo cost function (this is basically 2 for Super Cattle Prod and Mega Power Fist)
               NOTE: for hook type 2, this value is the ammo cost per round (default is always 1)
int     arg3 - Type of hook:
               0 - when subtracting ammo after single shot attack
               1 - when checking for "out of ammo" before attack
               2 - when calculating number of burst rounds
               3 - when subtracting ammo after burst attack

int     ret0 - The new amount of ammo to be consumed, or ammo cost per round for hook type 2 (set to 0 for unlimited ammo)
</code></pre></div></div> <h2 id="barterprice"> <a href="#barterprice" class="anchor-heading" aria-labelledby="barterprice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BarterPrice </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_BARTERPRICE</code> (hs_barterprice.int)</p> <p>Runs whenever the value of goods being purchased is calculated.</p> <p>NOTE: the hook is executed twice when entering the barter screen or after transaction: the first time is for the player and the second time is for NPC.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the bartering (either dude_obj or inven_dude)
Critter arg1 - the critter being bartered with
int     arg2 - the default value of the goods
Critter arg3 - table of requested goods (being bought from NPC)
int     arg4 - the number of actual caps in the barter stack (as opposed to goods)
int     arg5 - the value of all goods being traded before skill modifications
Critter arg6 - table of offered goods (being sold to NPC)
int     arg7 - the total cost of the goods offered by the player
int     arg8 - 1 if the "offers" button was pressed (not for a party member), 0 otherwise
int     arg9 - 1 if trading with a party member, 0 otherwise

int     ret0 - the modified value of all of the goods (pass -1 if you just want to modify offered goods)
int     ret1 - the modified value of all offered goods
</code></pre></div></div> <h2 id="bestweapon"> <a href="#bestweapon" class="anchor-heading" aria-labelledby="bestweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BestWeapon </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_BESTWEAPON</code> (hs_bestweapon.int)</p> <p>Runs when the AI decides which weapon is the best while searching the inventory for a weapon to equip in combat. This also runs when the player presses the “Use Best Weapon” button on the party member control panel.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter searching for a weapon
Item    arg1 - the best weapon chosen from two items
Item    arg2 - the first choice of weapon
Item    arg3 - the second choice of weapon
Critter arg4 - the target of the critter (can be 0)

Item    ret0 - overrides the chosen best weapon
</code></pre></div></div> <h2 id="buildsfxweapon"> <a href="#buildsfxweapon" class="anchor-heading" aria-labelledby="buildsfxweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BuildSfxWeapon </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_BUILDSFXWEAPON</code> (hs_buildsfxweapon.int)</p> <p>Runs before each weapon sound effect is played or put in the animation queue to determine the name of sound effect file based on the weapon, target and action being performed.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - weapon sound effect type: 0 - ready/reload, 1 - attack, 2 - out of ammo, 3 - flying (for projectile weapons), 4 - hit
Item    arg1 - the weapon being used
int     arg2 - attack type (see ATKTYPE_* constants)
Obj     arg3 - target of the attack (can be 0)

String  ret0 - the new sound file name to use, without extension (relative to "sound\sfx" path)
</code></pre></div></div> <h2 id="calcapcost"> <a href="#calcapcost" class="anchor-heading" aria-labelledby="calcapcost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CalcAPCost </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_CALCAPCOST</code> (hs_calcapcost.int)</p> <p>Runs whenever Fallout calculates the AP cost of using an active item in hand (or unarmed attack). Doesn’t run for moving.<br /> Note that the first time a game is loaded, this script doesn’t run before the initial interface is drawn, so if the script effects the AP cost of whatever is in the player’s hands at the time the wrong AP cost will be shown. It will be fixed the next time the interface is redrawn.<br /> You can get the weapon object by checking item slot based on attack type (<code class="language-plaintext highlighter-rouge">ATKTYPE_LWEP1</code>, <code class="language-plaintext highlighter-rouge">ATKTYPE_LWEP2</code>, etc) and then calling <code class="language-plaintext highlighter-rouge">critter_inven_obj</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The critter performing the action
int     arg1 - Attack Type (see ATKTYPE_* constants)
int     arg2 - Is aimed attack (1 or 0)
int     arg3 - The default AP cost
Item    arg4 - The weapon for which the cost is calculated. If it is 0, the pointer to the weapon can still be obtained by the aforementioned method

int     ret0 - The new AP cost
</code></pre></div></div> <h2 id="canuseweapon"> <a href="#canuseweapon" class="anchor-heading" aria-labelledby="canuseweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CanUseWeapon </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_CANUSEWEAPON</code> (hs_canuseweapon.int)</p> <p>Run when the AI checks whether it can use a weapon. This mostly happens when NPCs try to find weapons in their inventory or on the map.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the check
Item    arg1 - the weapon being checked
int     arg2 - attack type (see ATKTYPE_* constants)
int     arg3 - original result of engine function: 1 - can use, 0 - cannot use

int     ret0 - overrides the result of engine function. Any non-zero value allows using the weapon

## CarTravel

`HOOK_CARTRAVEL` (hs_cartravel.int)

Runs continuously during world map travel by car.

</code></pre></div></div> <p>int arg0 - vanilla car speed (between 3 and 8 “steps”) int arg1 - vanilla fuel consumption (100 and below)</p> <p>int ret0 - car speed override (pass -1 if you just want to override fuel consumption) int ret1 - fuel consumption override</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## CombatDamage

`HOOK_COMBATDAMAGE` (hs_subcombatdmg.int)

Runs when:
1.  Game calculates how much damage each target will get. This includes primary target as well as all extras (explosions and bursts). This happens BEFORE the actual attack animation.
2.  AI decides whether it is safe to use area attack (burst, grenades), if he might hit friendlies.

Does not run for misses, or non-combat damage like dynamite explosions.

</code></pre></div></div> <p>Critter arg0 - The target Critter arg1 - The attacker int arg2 - The amount of damage to the target int arg3 - The amount of damage to the attacker int arg4 - The special effect flags for the target (use bwand DAM_* to check specific flags) int arg5 - The special effect flags for the attacker (use bwand DAM_* to check specific flags) Item arg6 - The weapon used in the attack int arg7 - The bodypart that was struck int arg8 - Damage Multiplier (this is divided by 2, so a value of 3 does 1.5x damage, and 8 does 4x damage. Usually it’s 2; for critical hits, the value is taken from the critical table; with Silent Death perk and the corresponding attack conditions, the value will be doubled) int arg9 - Number of bullets actually hit the target (1 for melee attacks) int arg10 - The amount of knockback to the target int arg11 - Attack Type (see ATKTYPE_* constants) mixed arg12 - computed attack data (see C_ATTACK_* for offsets and use get/set_object_data functions to get/set the data)</p> <p>int ret0 - The damage to the target int ret1 - The damage to the attacker int ret2 - The special effect flags for the target int ret3 - The special effect flags for the attacker int ret4 - The amount of knockback to the target</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## CombatTurn

`HOOK_COMBATURN` (hs_combatturn.int)

Runs before and after each turn in combat (for both PC and NPC).

</code></pre></div></div> <p>int arg0 - event type: 1 - start of turn 0 - normal end of turn -1 - combat ends abruptly (by script or by pressing Enter during PC turn) -2 - combat ends normally (hook always runs at the end of combat) Critter arg1 - critter doing the turn int arg2 - 1 at the start/end of the player’s turn after loading a game saved in combat mode, 0 otherwise</p> <p>int ret0 - pass 1 at the start of turn to skip the turn, pass -1 at the end of turn to force end of combat</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## DeathAnim1

`HOOK_DEATHANIM1` (hs_deathanim1.int)

Runs before Fallout tries to calculate the death animation. Lets you switch out which weapon Fallout sees.

Does not run for critters in the knockdown/out state.

</code></pre></div></div> <p>int arg0 - The pid of the weapon performing the attack. (May be -1 if the attack is unarmed) Critter arg1 - The attacker Critter arg2 - The target int arg3 - The amount of damage int arg4 - Unused, always -1. Use this if you are using the same procedure for HOOK_DEATHANIM1 and HOOK_DEATHANIM2 (since sfall 4.1/3.8.24)</p> <p>int ret0 - The pid of an object to override the attacking weapon with</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## DeathAnim2

`HOOK_DEATHANIM2` (hs_deathanim2.int)

Runs after Fallout has calculated the death animation. Lets you set your own custom frame id, so more powerful than `HOOK_DEATHANIM1`, but performs no validation.&lt;br&gt;
When using `critter_dmg` function, this script will also run. In that case weapon pid will be -1 and attacker will point to an object with `obj_art_fid == 0x20001F5`.

Does not run for critters in the knockdown/out state.

</code></pre></div></div> <p>int arg0 - The pid of the weapon performing the attack. (May be -1 if the attack is unarmed) Critter arg1 - The attacker Critter arg2 - The target int arg3 - The amount of damage int arg4 - The death anim id calculated by Fallout</p> <p>int ret0 - The death anim id to override with</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Deprecated hooks

* `hs_hexmoveblocking.int`
* `hs_hexaiblocking.int`
* `hs_hexshootblocking.int`
* `hs_hexsightblocking.int`

Run when checking to see if a hex blocks movement or shooting. (or ai-ing, presumably...)

__NOTE:__ These hook scripts can become very CPU-intensive and you should avoid using them.
For this reason, these hooks are not thoroughly supported in sfall, and may be removed in future versions.&lt;br&gt;
If you want to check if some tile or path is blocked, use functions: `obj_blocking_tile`, `obj_blocking_line`, `path_find_to`.&lt;br&gt;
If you want script to be called every time NPC moves by hex in combat, use `HOOK_MOVECOST` hook.

</code></pre></div></div> <p>Critter arg0 - the critter doing the moving int arg1 - the tile number being checked int arg2 - the elevation being checked int arg3 - 1 if the hex would normally be blocking</p> <p>Obj ret0 - 0 if the hex doesn’t block, or any sort of object pointer if it does</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## DescriptionObj

`HOOK_DESCRIPTIONOBJ` (hs_descriptionobj.int)

Runs when using the examine action icon to display the description of an object. You can override the description text.
An example usage would be to add an additional description to the item based on player's stats/skills.

Does not run if the script of the object overrides the description.

__NOTE:__ Returning a pointer to the new text received from the `get_string_pointer` function is still valid, but the method is DEPRECATED and is left for backward compatibility only.

</code></pre></div></div> <p>Obj arg0 - the object</p> <p>String ret0 - the new description text to use</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Encounter

`HOOK_ENCOUNTER` (hs_encounter.int)

Runs whenever a random encounter occurs (except the Horrigan meeting and scripted encounters), or when the player enters a local map from the world map.
You can override the map for loading or the encounter.

</code></pre></div></div> <p>int arg0 - event type: 0 - when a random encounter occurs, 1 - when the player enters from the world map int arg1 - the map ID that the encounter will load (see MAPS.h or Maps.txt) int arg2 - 1 when the encounter occurs is a special encounter, 0 otherwise int arg3 - encounter table number, or -1 if not an encounter int arg4 - encounter index in the table, or -1 if not an encounter</p> <p>int ret0 - overrides the map ID, or pass -1 for event type 0 to cancel the encounter and continue traveling int ret1 - pass 1 to cancel the encounter and load the specified map from the ret0 (only for event type 0)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## ExplosiveTimer

`HOOK_EXPLOSIVETIMER` (hs_explosivetimer.int)

Runs after setting the explosive timer. You can override the result.

</code></pre></div></div> <p>int arg0 - the time in ticks set in the timer Obj arg1 - the explosive object int arg2 - the result of engine calculation of whether the timer was set successfully: 1 - failure, 2 - success (similar to ROLL_* in Condtion.h)</p> <p>int ret0 - overrides the time of the timer (maximum 18000 ticks) int ret1 - overrides the result of engine calculation: 0/1 - failure, 2/3 - success (similar to ROLL_*), any other value - use engine handler</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## FindTarget

`HOOK_FINDTARGET` (hs_findtarget.int)

Runs when the AI is trying to pick a target in combat. Fallout first chooses a list of 4 likely suspects, then normally sorts them in order of weakness/distance/etc depending on the AI caps of the attacker.&lt;br&gt;
This hook replaces that sorting function, allowing you to sort the targets in some arbitrary way.

The return values can include critters that weren't in the list of possible targets, but the additional targets may still be discarded later on in the combat turn if they are out of the attackers perception or the chance of a successful hit is too low. The list of possible targets often includes duplicated entries, but this is fixed in sfall 4.2.3/3.8.23.
Use `set_sfall_return` to give the 4 targets, in order of preference. If you want to specify less than 4 targets, fill in the extra spaces with 0's or pass -1 to skip the return value.

__NOTE:__ The engine can choose targets by the following criteria:
1) The nearest enemy to the attacker.
2) The enemy that attacked the attacker.
3) The enemy that attacked an NPC from the same team as the attacker.
4) The enemy that is attacked by an NPC from the same team as the attacker.

</code></pre></div></div> <p>Critter arg0 - The attacker Critter arg1 - A possible target Critter arg2 - A possible target Critter arg3 - A possible target Critter arg4 - A possible target</p> <p>Critter ret0 - The first choice of target Critter ret1 - The second choice of target Critter ret2 - The third choice of target Critter ret3 - The fourth choice of target</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## GameModeChange

`HOOK_GAMEMODECHANGE` (hs_gamemodechange.int)

Runs once every time when the game mode was changed, like opening/closing the inventory, character screen, pipboy, etc.

</code></pre></div></div> <p>int arg0 - event type: 1 - when the player exits the game, 0 - otherwise int arg1 - the previous game mode</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## InvenWield

`HOOK_INVENWIELD` (hs_invenwield.int)

Runs before causing a critter or the player to wield/unwield an armor or a weapon (except when using the inventory by PC).
An example usage would be to change critter art depending on armor being used or to dynamically customize weapon animations.

__NOTE:__ When replacing a previously wielded armor or weapon, the unwielding hook will not be executed.
If you need to rely on this, try checking if armor/weapon is already equipped when wielding hook is executed.

</code></pre></div></div> <p>Critter arg0 - critter Item arg1 - item being wielded or unwielded (weapon/armor) int arg2 - slot (INVEN_TYPE_*) int arg3 - 1 when wielding, 0 when unwielding int arg4 - 1 when removing an equipped item from inventory, 0 otherwise</p> <p>int ret0 - overrides hard-coded handler (-1 - use engine handler, any other value - override) - NOT RECOMMENDED</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## InventoryMove

`HOOK_INVENTORYMOVE` (hs_inventorymove.int)

Runs before moving items between inventory slots in dude interface. You can override the action.

What you can NOT do with this hook:
- force moving items to inappropriate slots (like gun in armor slot)
What you can do:
- restrict player from using specific weapons or armors
- add AP costs for all inventory movement including reloading
- apply or remove some special scripted effects depending on PC's armor

</code></pre></div></div> <p>int arg0 - Target slot: 0 - main backpack 1 - left hand 2 - right hand 3 - armor slot 4 - weapon, when reloading it by dropping ammo 5 - container, like bag/backpack 6 - dropping on the ground 7 - picking up item 8 - dropping item on the character portrait Item arg1 - Item being moved Item arg2 - Item being replaced, weapon being reloaded, or container being filled (can be 0)</p> <p>int ret0 - Override setting (-1 - use engine handler, any other value - prevent relocation of item/reloading weapon/picking up item)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Notes for the event of dropping items on the ground:
- the event is called for each item when dropping multiple items from the stack
- for ammo type items, the number of dropped ammo in a pack can be found by using the `get_weapon_ammo_count` function
- for the `PID_BOTTLE_CAPS` item, the event is called only once, and the number of dropped units can be found from the value of the `OBJ_DATA_CUR_CHARGES` object field (or with the `get_weapon_ammo_count` function)

## ItemDamage

`HOOK_ITEMDAMAGE` (hs_itemdamage.int)

Runs when retrieving the damage rating of the player's used weapon. (Which may be their fists.)

</code></pre></div></div> <p>int arg0 - The default min damage int arg1 - The default max damage Item arg2 - The weapon used (0 if unarmed) Critter arg3 - The critter doing the attacking int arg4 - The type of attack int arg5 - non-zero if this is an attack using a melee weapon</p> <p>int ret0 - Either the damage to be used, if ret1 isn’t given, or the new minimum damage if it is int ret1 - The new maximum damage</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## KeyPress

`HOOK_KEYPRESS` (hs_keypress.int)

Runs once every time when any key was pressed or released.
* DX codes: see **dik.h** header or https://kippykip.com/b3ddocs/commands/scancodes.htm
* [VK codes](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx)

__NOTE:__ If you want to override a key, the new key DX scancode should be the same for both pressed and released events.

</code></pre></div></div> <p>int arg0 - event type: 1 - pressed, 0 - released int arg1 - key DX scancode int arg2 - key VK code (very similar to ASCII codes)</p> <p>int ret0 - overrides the pressed key (a new key DX scancode or 0 for no override)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## MouseClick

`HOOK_MOUSECLICK` (hs_mouseclick.int)

Runs once every time when a mouse button was pressed or released.

</code></pre></div></div> <p>int arg0 - event type: 1 - pressed, 0 - released int arg1 - button number (0 - left, 1 - right, up to 7)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## MoveCost

`HOOK_MOVECOST` (hs_movecost.int)

Runs when calculating the AP cost of movement.

</code></pre></div></div> <p>Critter arg0 - the critter doing the moving int arg1 - the number of hexes being moved int arg2 - the original AP cost</p> <p>int ret0 - the new AP cost</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## OnDeath

`HOOK_ONDEATH` (hs_ondeath.int)

Runs immediately after a critter dies for any reason. No return values; this is just a convenience for when you need to do something after death for a large number of different critters and don't want to have to script each and every one of them.

</code></pre></div></div> <p>Critter arg0 - The critter that just died</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## OnExplosion

`HOOK_ONEXPLOSION` (hs_onexplosion.int)

Runs when Fallout is checking all the tiles within the explosion radius for targets before an explosion occurs.
The tile checking will be interrupted when 6 additional targets (critters) are received.

</code></pre></div></div> <p>int arg0 - event type: 1 - when checking objects within the explosion radius without causing damage (e.g. the player drops an active explosive), 0 - otherwise Critter arg1 - the attacker int arg2 - the tile on which the explosion occurs int arg3 - checked tile within the explosion radius Obj arg4 - first found object on the checked tile as an additional target Critter arg5 - the target critter, may be 0 or equal to the attacker int arg6 - 1 when using throwing weapons (e.g. grenades), 0 otherwise</p> <p>int ret0 - overrides the found object on the checked tile, pass 0 to skip the object</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## RemoveInvenObj

`HOOK_REMOVEINVENOBJ` (hs_removeinvenobj.int)

Runs when an object is removed from a container or critter's inventory for any reason.

</code></pre></div></div> <p>Obj arg0 - the owner that the object is being removed from Item arg1 - the item that is being removed int arg2 - the number of items to remove int arg3 - The reason the object is being removed (see RMOBJ_* constants) Obj arg4 - The destination object when the item is moved to another object, 0 otherwise</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## RestTimer

`HOOK_RESTTIMER` (hs_resttimer.int)

Runs continuously while the player is resting (using pipboy alarm clock).

</code></pre></div></div> <p>int arg0 - the game time in ticks int arg1 - event type: 1 - when the resting ends normally, -1 - when pressing ESC to cancel the timer, 0 - otherwise int arg2 - the hour part of the length of resting time int arg3 - the minute part of the length of resting time</p> <p>int ret0 - pass 1 to interrupt the resting, pass 0 to continue the rest if it was interrupted by pressing ESC key</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## RollCheck

`HOOK_ROLLCHECK` (hs_rollcheck.int)

Runs when a game event performs a random roll to check the chance of success or failure.

</code></pre></div></div> <p>int arg0 - event type: 1 - checks the chance of an attack hitting the target 2 - checks the chance of a bullet from a burst hitting the target (for burst attacks) 3 - checks the chance when using skills (not listed below) 4 - check the chance of using Repair skill 5 - check the chance of using Doctor skill 6 - check the chance of using Steal skill for the thief (usually the player) 7 - the second Steal skill chance check for the target to catch the thief, in which the target’s failure is the thief’s success result int arg1 - the value of roll result (see ROLL_* constants), which is calculated as: for ROLL_CRITICAL_SUCCESS: random(1, 100) &lt;= (random_chance / 10) + bonus for ROLL_CRITICAL_FAILURE: random(1, 100) &lt;= -random_chance / 10 int arg2 - the chance value int arg3 - the bonus value, used when checking critical success int arg4 - random chance (calculated as: chance - random(1, 100)), where a negative value is a failure check (ROLL_FAILURE)</p> <p>int ret0 - overrides the roll result</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## SetGlobalVar

`HOOK_SETGLOBALVAR` (hs_setglobalvar.int)

Runs when setting the value of a global variable.

</code></pre></div></div> <p>int arg0 - the index number of the global variable being set int arg1 - the set value of the global variable</p> <p>int ret0 - overrides the value of the global variable</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## SetLighting

`HOOK_SETLIGHTING` (hs_setlighting.int)

Runs before setting the light level for an object or a map. You can override the result.

</code></pre></div></div> <p>Obj arg0 - the object being set, or -1 when setting the light level for a map int arg1 - the light intensity int arg2 - the light radius, or -1 when setting the light level for a map</p> <p>int ret0 - overrides the light intensity. Intensity range is from 0 to 65536 int ret1 - overrides the light radius. Radius range is from 0 to 8 (works only for the object)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Sneak

`HOOK_SNEAK` (hs_sneak.int)

Runs when the Sneak skill is activated, or when the game rolls another Sneak check after the duration for the current one is over.
You can override the result of a random Sneak check or the duration time for the current result.

</code></pre></div></div> <p>int arg0 - Sneak check result: 1 - success, 0 - failure int arg1 - the duration in ticks for the current Sneak check (time depends on Sneak skill level) Critter arg2 - the critter (usually dude_obj)</p> <p>int ret0 - overrides the result of the Sneak check int ret1 - overrides the duration time for the current result</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## StdProcedure

`HOOK_STDPROCEDURE` (hs_stdprocedure.int)

Runs before Fallout executes a standard procedure (handler) in any script of any object.
NOTE: this hook will not be executed for `start`, `critter_p_proc`, `timed_event_p_proc`, and `map_update_p_proc` procedures.

</code></pre></div></div> <p>int arg0 - the number of the standard script handler (see *_proc in define.h) Obj arg1 - the object that owns this handler (self_obj) Obj arg2 - the object that called this handler (source_obj, can be 0) int arg3 - always 0 (1 for _END version) Obj arg4 - the object that is acted upon by this handler (target_obj, can be 0) int arg5 - the parameter of this call (fixed_param), useful for combat_proc</p> <p>int ret0 - pass -1 to cancel the execution of the handler</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## StdProcedureEnd

`HOOK_STDPROCEDURE_END` (hs_stdprocedure.int)

Runs after Fallout executes a standard procedure (handler) in any script of any object.
NOTE: this hook will not be executed for `start`, `critter_p_proc`, `timed_event_p_proc`, and `map_update_p_proc` procedures.

</code></pre></div></div> <p>int arg0 - the number of the standard script handler (see *_proc in define.h) Obj arg1 - the object that owns this handler (self_obj) Obj arg2 - the object that called this handler (source_obj, can be 0) int arg3 - always 1 (procedure end) Obj arg4 - the object that is acted upon by this handler (target_obj, can be 0) int arg5 - the parameter of this call (fixed_param), useful for combat_proc</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Steal

`HOOK_STEAL` (hs_steal.int)

Runs when checking an attempt to steal or plant an item in other inventory using Steal skill.

This is fired before the default handlers are called, which you can override. In this case you MUST provide message of the result to player ("You steal the %s", "You are caught planting the %s", etc.).
Example message (vanilla behavior):&lt;br&gt;
`display_msg(sprintf(mstr_skill(570 + (isSuccess != false) + arg3 * 2), obj_name(arg2)));`

</code></pre></div></div> <p>Critter arg0 - Thief Obj arg1 - The target Item arg2 - The item being stolen/planted int arg3 - 0 when stealing, 1 when planting int arg4 - quantity of the item being stolen/planted</p> <p>int ret0 - overrides hard-coded handler (2 - force fail without closing window, 1 - force success, 0 - force fail, -1 - use engine handler) int ret1 - overrides experience points gained for stealing this item (must be greater than or equal to 0)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## SubCombatDamage

`HOOK_SUBCOMBATDAMAGE` (hs_subcombatdamage.int)

This hook overrides the vanilla damage calculation formula.
Runs when:
1. Before the game calculates how much damage each target will get. This includes primary target as well as all extras (explosions and bursts).
2. AI decides whether it is safe to use area attack (burst, grenades), if he might hit friendlies.

Does not run for misses, non-combat damage like dynamite explosions, or if one of the damage formulas is selected in ddraw.ini.

</code></pre></div></div> <p>Critter arg0 - the attacker Critter arg1 - the target Item arg2 - the weapon used in the attack int arg3 - attack type (see ATKTYPE_* constants) int arg4 - number of bullets actually hit the target (1 for melee attacks) int arg5 - target’s Damage Resistance (DR) value (affected by critical hit effects, perks, traits, and special unarmed attacks) int arg6 - target’s Damage Threshold (DT) value (affected by critical hit effects, perks, traits, and special unarmed attacks) int arg7 - bonus ranged damage from the perk int arg8 - damage multiplier (this is divided by 2, so a value of 3 does 1.5x damage, and 8 does 4x damage. Usually it’s 2; for critical hits, the value is taken from the critical table; with Silent Death perk and the corresponding attack conditions, the value will be doubled) int arg9 - combat difficulty multiplier (125 - rough, 100 - normal, 75 - wimpy; for player or party members it’s always 100) int arg10 - the calculated amount of damage (usually 0, required when using multiple hook scripts to calculate damage and using the set_sfall_arg function) mixed arg11 - computed attack data (see C_ATTACK_* for offsets and use get/set_object_data functions to get/set the data)</p> <p>int ret0 - the returned amount of damage</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## TargetObject

`HOOK_TARGETOBJECT` (hs_targetobject.int)

Runs when the targeting cursor hovers over an object, or when the player tries to attack the target object.
You can override the target object or prevent the player from attacking the chosen target.

</code></pre></div></div> <p>int arg0 - event type: 0 - when the targeting cursor hovers over the object, 1 - when trying to attack the target object int arg1 - 1 when the target object is valid to attack, 0 otherwise Obj arg2 - the target object</p> <p>mixed ret0 - overrides the target object, or pass -1 to prevent the player from attacking the object</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## ToHit

`HOOK_TOHIT` (hs_tohit.int)

Runs when Fallout is calculating the chances of an attack striking a target.&lt;br&gt;
Runs after the hit chance is fully calculated normally, including applying the 95% cap.

</code></pre></div></div> <p>int arg0 - The hit chance (capped) Critter arg1 - The attacker Critter arg2 - The target of the attack int arg3 - The targeted bodypart int arg4 - Source tile (may differ from attacker’s tile, when AI is considering potential fire position) int arg5 - Attack Type (see ATKTYPE_* constants) int arg6 - Ranged flag. 1 if the hit chance calculation takes into account the distance to the target. This does not mean the attack is a ranged attack int arg7 - The raw hit chance before applying the cap</p> <p>int ret0 - The new hit chance. The value is limited to the range of -99 to 999</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## UseAnimObj

`HOOK_USEANIMOBJ` (hs_useanimobj.int)

Runs before playing the "use" (usually "magic hands") animation when a critter uses a scenery/container object on the map, or before walking/running animation if the player is at a distance from the object.

</code></pre></div></div> <p>Critter arg0 - the critter that uses an object (usually dude_obj) Obj arg1 - the object being used int arg2 - the animation code being used (see ANIM_* in Animcomd.h)</p> <p>int ret0 - overrides the animation code (pass -1 if you want to skip the animation)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## UseObj

`HOOK_USEOBJ` (hs_useobj.int)

Runs when:
1. a critter uses an object from inventory which have "Use" action flag set or it's an active flare or dynamite.
2. player uses an object from main interface

This is fired before the object is used, and the relevant `use_obj` script procedures are run. You can disable default item behavior.

__NOTE:__ You can't remove and/or destroy this object during the hookscript (game will crash otherwise). To remove it, return 1.

</code></pre></div></div> <p>Critter arg0 - The user Obj arg1 - The object used</p> <p>int ret0 - overrides hard-coded handler and selects what should happen with the item (0 - place it back, 1 - remove it, -1 - use engine handler)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## UseObjOn

`HOOK_USEOBJON` (hs_useobjon.int)

Runs when:
1. a critter uses an object on another critter. (Or themselves)
1. a critter uses an object from inventory screen AND this object does not have "Use" action flag set and it's not active flare or explosive.
1. player or AI uses any drug

This is fired before the object is used, and the relevant `use_obj_on` script procedures are run. You can disable default item behavior.

__NOTE:__ You can't remove and/or destroy this object during the hookscript (game will crash otherwise). To remove it, return 1.

</code></pre></div></div> <p>Critter arg0 - The target Critter arg1 - The user int arg2 - The object used</p> <p>int ret0 - overrides hard-coded handler and selects what should happen with the item (0 - place it back, 1 - remove it, -1 - use engine handler)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## UseSkill

`HOOK_USESKILL` (hs_useskill.int)

Runs when using any skill on any object.

This is fired before the default handlers are called, which you can override. In this case you should write your own skill use handler entirely, or otherwise nothing will happen (this includes fade in/fade out, time lapsing and messages - all of this can be scripted; to get vanilla text messages - use `message_str_game` along with `sprintf`).
Suggested use - override First Aid/Doctor skills to buff/nerf them, override Steal skill to disallow observing NPCs inventories in some cases.

Does not run if the script of the object calls `script_overrides` for using the skill.

</code></pre></div></div> <p>Critter arg0 - The user critter Obj arg1 - The target object int arg2 - skill being used int arg3 - skill bonus from items such as first aid kits</p> <p>int ret0 - overrides hard-coded handler (-1 - use engine handler, any other value - override; if it is 0, there will be a 10% chance of removing the used medical item)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## UseSkillOn

`HOOK_USESKILLON` (hs_useskillon.int)

Runs before using any skill on any object. Lets you override the critter that uses the skill.

__NOTE:__ The user critter can't be overridden when using Steal skill.

</code></pre></div></div> <p>Critter arg0 - the user critter (usually dude_obj) Obj arg1 - the target object/critter int arg2 - skill being used</p> <p>int ret0 - a new critter to override the user critter. Pass -1 to cancel the skill use, pass 0 to skip this return value int ret1 - pass 1 to allow the skill to be used in combat (only for dude_obj or critter being controlled by the player)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## WithinPerception

`HOOK_WITHINPRECEPTION` (hs_withinperception.int)

Runs when checking if one critter sees another critter. This is used in different situations like combat AI. You can override the result.

__NOTE:__ `obj_can_see_obj` calls this first when deciding if critter can possibly see another critter with regard to perception, lighting, sneak factors.&lt;br&gt;
If check fails, the end result is false. If check succeeds (e.g. critter is within perception range), another check is made if there is any blocking tile between two critters (which includes stuff like windows, large bushes, barrels, etc.) and if there is - check still fails.&lt;br&gt;
You can override "within perception" check by returning 0 or 1, OR, as a convenience, you can also override blocking check after the perception check by returning 2 instead. In this case you should add "line of sight" check inside your hook script, otherwise critters will detect you through walls.

This is fired after the default calculation is made.

</code></pre></div></div> <p>Critter arg0 - Watcher object Obj arg1 - Target object int arg2 - Result of vanilla function: 1 - within perception range, 0 - otherwise int arg3 - Type of hook: 1 - when being called from obj_can_see_obj script function 2 - when being called from obj_can_hear_obj script function (need to set ObjCanHearObjFix=1 in ddraw.ini) 3 - when AI determines whether it sees a potential target when selecting attack targets 0 - all other cases</p> <p>int ret0 - overrides the returned result of the function: 0 - not in range (can’t see) 1 - in range (will see if not blocked) 2 - forced detection (will see regardless, only used in obj_can_see_obj script function which is called by every critter in the game) ```</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
